!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=3)}([function(e,t,i){},function(e,t){},,function(e,t,i){"use strict";i.r(t);i(0);const n={"booking-reference-number":"Booking Reference Number","customer-name":"Customer Name","customer-email":"Customer Email","booking-date":"Booking Date","booking-action":"Booking Action","keep-donation-no":"Issue refund","keep-donation-yes":"Keep donation","preferred-date":"Preferred Date","preferred-time":"Preferred Time",otherdays:"Other Days","additional-comments":"Additional Comments","preferred-email":"Preferred Email"},o=["success-path","email-to-address","g-recaptcha-response"];var s={handleBuildingErrorEmail(e){const t=document.querySelector("#booking-cancellation-email");e.addEventListener("change",(function(){const i=new FormData(e),s="mailto:bookingsupport@nhm.ac.uk?subject=Requested booking update&body="+Array.from(i.entries()).filter(([e,t])=>t&&n[e]).filter(([e,t])=>!o.includes(e)).map(([e,t])=>`${n[e]}: ${t}`).join("%0D%0A");t.href=s}))},init(){const e=document.querySelector(".booking-cancellation-form");e&&this.handleBuildingErrorEmail(e)}},r={mapRange:(e,t,i,n,o)=>((e=n+(e=(e-t)/(i-t))*(o-n))<n&&(e=n),e>o&&(e=o),e),setSVGSizes(){const e=document.querySelector(".dinosaur--comparison-dino"),t=parseFloat(document.querySelector(".dinosaur--description").getAttribute("data-dino-length"));let i=1;const n=t/(e.offsetWidth?e.offsetWidth/e.offsetHeight:1.5);let o="human-look-ahead";i=this.mapRange(n,0,5,.5,1),(n<1||t<=1.5)&&(i=this.mapRange(n,0,5,.45,1.3),o="human-crouching");const s=i+t,r=100/s*t,a=100/s*i,l=document.querySelector(".dinosaur--comparison-human"),c=document.querySelector(".dinosaur--comparison-dino");l.innerHTML='<img alt="human silhouette for scale comparison" src="/etc.clientlibs/nhmwww/clientlibs/clientlib-site/resources/images/svgs/dinodirectory/human/'+o+'.svg"/>',l.style.width=a+"%",c.style.width=r+"%"},init(){document.querySelector(".dinosaur--comparison-human")&&this.setSVGSizes()}},a={pushInteractionEvent(e){window.dataLayer.push({event:"GAEvent",eventCategory:"user experience",eventAction:"horizontalnav interaction - direction button clicked",eventLabel:""+(e?"horizontalnav next button clicked":"horizontalnav prev button clicked")})},handleScrollButton(){[document.querySelector("[data-horizontalnav-prev]"),document.querySelector("[data-horizontalnav-next]")].forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const i="true"===e.dataset.horizontalnavNext,n=i?50:-50;document.querySelector(".horizontalnav__list").scrollBy({left:n,behavior:"smooth"}),this.pushInteractionEvent(i)})})},hideOrShowButton(e,t,i){const n=t.offsetWidth,o=e<n;t.dataset.hidden=o?"true":"false"},handlePrevAndNextButtons(){const e=document.querySelector(".horizontalnav__list"),t=document.querySelector("[data-horizontalnav-prev]"),i=document.querySelector("[data-horizontalnav-next]");let n=e.scrollLeft;e.addEventListener("scroll",()=>{n=e.scrollLeft,t.dataset.hidden=n<=0?"true":"false",n>=e.scrollWidth-e.offsetWidth?i.dataset.hidden="true":i.dataset.hidden="false"})},handlePositionActiveElement(){const e=document.querySelector(".horizontalnav__list--active");if(!e)return;const t=document.querySelector(".horizontalnav__list"),i=e.offsetLeft;if(t.scrollTo({left:i-50,behavior:"smooth"}),i>0){document.querySelector("[data-horizontalnav-prev]").dataset.hidden="true"}const n=document.querySelector("[data-horizontalnav-next]");i>=t.offsetWidth?n.dataset.hidden="true":n.dataset.hidden="false"},init(){document.querySelector(".horizontalnav")&&(this.handlePositionActiveElement(),this.handleScrollButton(),this.handlePrevAndNextButtons())}},l=(i(1),{LIKE_CONTAINERS:null,LIKE_BUTTON:null,LIKE_COUNTS:null,LIKES:{value:"0",pagePath:"",displayText:"0",get getLikes(){return this.value},set setLikes(e){this.value=e}},setupCounter(){const e=this;e.LIKE_CONTAINERS=document.querySelectorAll(".like-container"),e.LIKE_COUNTS=document.querySelectorAll(".js-like-count"),e.LIKE_CONTAINERS&&e.LIKE_CONTAINERS.forEach(t=>{e.LIKE_BUTTON=t.querySelector(".like-button-link"),e.LIKES.pagePath=t.getAttribute("data-page-path"),e.LIKE_BUTTON&&e.LIKE_BUTTON.addEventListener("click",i=>e.updateLikes(i,t))})},updateLikes(e,t){const i=this;e.preventDefault(),this.LIKE_BUTTON&&fetch("/bin/likes",{method:"POST",headers:{"Page-Path":i.LIKES.pagePath}}).then(e=>e).then(e=>{i.LIKE_COUNTS.forEach(e=>{let t=e.innerText,n=parseInt(t);n+=1,i.LIKES.setLikes=n,e.innerText=i.LIKES.getLikes}),document.querySelectorAll(".like-button-link").forEach(e=>e.classList.add("disabled"))})},fetchLikes(){const e=this;this.LIKE_BUTTON&&fetch("/bin/likes",{method:"GET",headers:{"Page-Path":e.LIKES.pagePath}}).then(e=>e.json()).then(t=>{e.LIKES.setLikes=t.count,e.LIKE_COUNTS.forEach(t=>{t.innerText=parseInt(e.LIKES.getLikes)})})},init(){this.setupCounter(),this.fetchLikes()}}),c={NUM_OF_POSTS:10,NUM_OF_POSTS_SHOWING:10,LOAD_MORE_BUTTON:null,UPDATE_BUTTON:null,setPostsVisible(e,t,i=!1){this.NUM_OF_POSTS_SHOWING=t,e.forEach((e,i)=>{i<t&&e.removeAttribute("data-hidden")}),i&&e[t-this.NUM_OF_POSTS].querySelector("a").focus(),t>=e.length&&this.LOAD_MORE_BUTTON.remove()},handleUpdateButton(e,t){const i=document.querySelector(".global-header");t.addEventListener("click",e=>{i.style.opacity=0,setTimeout(()=>{i.style.transform="translateY(-150px)",i.style.opacity=1},600)}),window.addEventListener("scroll",()=>{window.pageYOffset>e.offsetTop?(t.style.width=e.offsetWidth+"px",t.classList.add("sticky")):t.classList.remove("sticky")})},handlePostTracking(e){if(!e.length)return;const t=Array.from(e).filter((e,t)=>t%3==0);t.shift(),t.forEach((e,t)=>e.setAttribute("data-index",3*t+3));let i=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){let i=e.target.getAttribute("data-index");window.dataLayer.push({event:"GAEvent",eventCategory:"Live blog scroll depth",eventAction:"Scrolled to post "+i,eventLabel:window.location.href}),t.unobserve(e.target)}})});t.forEach((e,t)=>i.observe(e))},removeNoPostsMessage(e){const t=document.querySelector(".live-blog__no-posts");e.length>0&&t.remove()},handleLinksToPosts(e){document.querySelectorAll('a[href^="#liveblogpost"').forEach(t=>{t.addEventListener("click",i=>{i.preventDefault();const n=t.getAttribute("href"),o=document.querySelector(n),s=Array.from(o.parentNode.children).indexOf(o);this.NUM_OF_POSTS_SHOWING<s+3&&this.setPostsVisible(e,s+3,n),o.scrollIntoView()})})},handleShowingBackToTopButton(){const e=document.querySelector(".live-blog--back-to-top"),t=document.querySelector(".live-blog .saved-articles__bookmark");window.onscroll=()=>{window.innerHeight<window.scrollY?(e.classList.add("visible"),e.setAttribute("data-state","active"),t.classList.add("move-up")):(e.classList.remove("visible"),e.setAttribute("data-state","inactive"),t.classList.remove("move-up"))}},handleQuoteAuthors(){document.querySelectorAll("b").forEach(e=>{null===e.nextSibling&&e.classList.add("quote-author")})},setupLiveBlog(){const e=this,t=document.querySelector(".liveblogcontainer");if(!t)return;e.LOAD_MORE_BUTTON=document.getElementById("live-blog__load-more"),e.UPDATE_BUTTON=document.querySelector(".live-post__update-button");const i=document.querySelectorAll(".live-post");this.handleUpdateButton(t,e.UPDATE_BUTTON),this.handlePostTracking(i),this.removeNoPostsMessage(i),this.handleLinksToPosts(i),this.handleShowingBackToTopButton(),this.handleQuoteAuthors(),i.forEach((t,i)=>i>=e.NUM_OF_POSTS&&t.setAttribute("data-hidden","")),e.setPostsVisible(i,e.NUM_OF_POSTS),0===i.length&&e.LOAD_MORE_BUTTON.remove();new IntersectionObserver((t,n)=>{t.forEach(t=>{t.isIntersecting&&e.setPostsVisible(i,e.NUM_OF_POSTS_SHOWING+e.NUM_OF_POSTS)})},{rootMargin:"0% 0% 100% 0%",threshold:0}).observe(e.LOAD_MORE_BUTTON),e.LOAD_MORE_BUTTON.addEventListener("click",()=>e.setPostsVisible(i,e.NUM_OF_POSTS_SHOWING+e.NUM_OF_POSTS,!0))},init(){this.setupLiveBlog()}},d={setupQQHubGTM(){const e=document.querySelectorAll(".qq-hub");e&&e.forEach(e=>{e.querySelectorAll(".qq-hub--question").forEach((e,t)=>{e.addEventListener("click",()=>{if(e.open)return;const i=e.querySelector("summary").textContent.trim();window.dataLayer.push({event:"GAEvent",eventCategory:"Quick question opened",eventAction:"Opened question "+t,eventLabel:i})})})})},init(){this.setupQQHubGTM()}},u={GAEvent(){window.dataLayer.push({event:"GAEvent",eventCategory:"scroll depth",eventAction:"Social share in view",eventLabel:window.location.href})},AdobeLaunchEvent(){const e={event:"componentInteraction",component:{type:"scroll depth",name:"",action:"social share in view",details:window.location.href}},t=new CustomEvent("dataLayerEvent",{detail:e});console.log("dataLayerEvent",{detail:e}),document.querySelector("body").dispatchEvent(t)},setupGAScrollTrigger(){const e=document.querySelector(".ga-scroll-event-target");if(e&&window.IntersectionObserver){new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(this.GAEvent(),this.AdobeLaunchEvent(),t.unobserve(e.target))})}).observe(e)}},init(){this.setupGAScrollTrigger()}},h={pushInteractionEvent(e){window.dataLayer.push({event:"GAEvent",eventCategory:"user experience",eventAction:"subsection nav interaction - nav button clicked",eventLabel:""+(e?"subsection nav closed":"subsection nav opened")})},toggleOpenState(e,t,i){const n="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!n),t.style.transform=`rotate(${n?"0deg":"180deg"})`,i.setAttribute("aria-hidden",!n),i.classList.toggle("subnav-dropdown--open"),this.pushInteractionEvent(n)},init(){if(!document.querySelector(".subnav"))return;const e=document.querySelector(".subnav-button"),t=document.querySelector(".subnav-button__icon svg"),i=document.querySelector(".subnav-dropdown");e.addEventListener("click",()=>this.toggleOpenState(e,t,i)),document.addEventListener("click",n=>{if(n.target.closest(".subnav"))return;"true"===e.getAttribute("aria-expanded")&&(e.setAttribute("aria-expanded",!1),t.style.transform="rotate(0deg)",i.setAttribute("aria-hidden",!0),i.classList.remove("subnav-dropdown--open"))})}};var m=e=>{if(!e)return;let t=e.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])');const i=t[0],n=t[t.length-1];e.addEventListener("keydown",(function(e){("Tab"===e.key||9===e.keyCode)&&(e.shiftKey?document.activeElement===i&&(n.focus(),e.preventDefault()):document.activeElement===n&&(i.focus(),e.preventDefault()))}))};const v={init(){"NodeList"in window&&!NodeList.prototype.forEach&&(console.info("polyfill for IE11"),NodeList.prototype.forEach=function(e,t){t=t||window;for(var i=0;i<this.length;i++)e.call(t,this[i],i,this)})}},p={init(){Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return!1;var o,s,r=0|t,a=Math.max(r>=0?r:n-Math.abs(r),0);for(;a<n;){if((o=i[a])===(s=e)||"number"==typeof o&&"number"==typeof s&&isNaN(o)&&isNaN(s))return!0;a++}return!1}})}},b={init(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(Element.prototype.matches.call(t,e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null})}},g={classHandler(e){let t=document.querySelectorAll(e.target),i=e.classes.split(","),n=e.function?e.function:"toggle",o=!e.toggleAll||e.toggleAll;for(let e=0;e<t.length&&("toggle"===n?i.forEach(i=>{t[e].classList.toggle(i.trim())}):"add"===n?i.forEach(i=>{t[e].classList.add(i.trim())}):"remove"===n?i.forEach(i=>{t[e].classList.remove(i.trim())}):console.error('If "function" is present it must be set to "toggle", "add" or "remove"'),o);e++);},onEvent(e,t){e.preventDefault(),t.forEach(e=>{e.target&&e.classes?this.classHandler(e):console.error('"target" and "classes" are required')})},init(){window.classHandler=this.onEvent.bind(this)}},E={parseHref(e){if(!e)return!1;let t=e.indexOf("#")+1,i=e.indexOf("?")>-1?e.indexOf("?"):e.length,n=e.slice(t,i);return{query:e.slice(i),id:n}},scrollAnchors(e,t){const i=e=>Math.floor(e.getBoundingClientRect().top),n=document.querySelector("#"+e);if(!n)return;const o=()=>{0===i(n)&&(window.removeEventListener("scroll",o),t&&t())};window.addEventListener("scroll",o),o(),window.scrollBy({top:i(n),left:0,behavior:"smooth"})},clickOnTargetAfterScroll(e,t){let i=t?JSON.parse('{"'+decodeURI(t.slice(1)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}'):null;if(null!=i&&i.hasOwnProperty("find"))if("accordion"===i.find){const t=document.querySelector("#"+e).querySelector("[data-accordion]").querySelector("a");t&&t.click()}else{let e=document.querySelector(`a[href="#${i.find}"]`);e&&e.click()}},hashLinkOnLoadHandler(){let e=window.location.hash;if(!e)return;const{id:t,query:i}=E.parseHref(e);setTimeout(()=>{E.scrollAnchors(t,()=>E.clickOnTargetAfterScroll(t,i))},1e3)},hashLinkInit(){const e=Array.from(document.querySelectorAll("a:not(.js-no-scroll)"));let t=Array.from(document.querySelectorAll('.list__item a:not([role="tab"])'));e.filter(e=>{const t=e&&e.getAttribute("href");return t&&e.pathname===window.location.pathname&&t.includes("#")&&"#"!==t}).forEach(e=>{if(window.innerWidth<1024)return;const i=e.getAttribute("href").split("#")[1];e.href="#"+i,t.push(e)}),t.forEach(e=>{e.addEventListener("click",(function(t){t.preventDefault();const{id:i,query:n}=E.parseHref(e.getAttribute("href"));E.scrollAnchors(i,()=>E.clickOnTargetAfterScroll(i,n))}))})},init(){this.hashLinkOnLoadHandler(),this.hashLinkInit()}},f={init(){let e=document.querySelectorAll('[data-return-to-previous="true"]'),t=window.sessionStorage.getItem("currentPage");window.sessionStorage.setItem("currentPage",window.location.href),e.forEach(e=>{e.addEventListener("click",(function(e){window.location=t||"https://www.nhm.ac.uk"}))})}};var y={pushInteraction(e){window.dataLayer.push({event:"GAEvent",eventCategory:"user experience",eventAction:"mobile nav interaction - nav button clicked",eventLabel:e});const t={event:"componentInteraction",component:{type:"navigation",name:"mobile-nav",action:"mobile nav interaction - nav button clicked",details:e}},i=new CustomEvent("dataLayerEvent",{detail:t});console.log("dataLayerEvent",{detail:t}),document.querySelector("body").dispatchEvent(i)},setup(){const e=document.querySelector(".js--mobile-menu-toggle"),t=document.querySelector(".global-header");e.addEventListener("click",()=>{const e=t.classList.contains("is-active");this.pushInteraction(e?"mobile nav opened":"mobile nav closed")});document.querySelectorAll(".global-header__primary-nav-item a + button[aria-hidden='false']").forEach(e=>{e.addEventListener("click",()=>{const t=e.previousElementSibling.innerText;this.pushInteraction(t.toLowerCase()+" expansion button clicked")})});document.querySelectorAll(".global-header__nav-button--back").forEach(e=>{e.addEventListener("click",()=>this.pushInteraction("mobile nav back button clicked"))})},init(){window.innerWidth>=1024||this.setup()}},S={COOKIE_PREFERENCES:{"nhm-functional-202308":{value:null,exists:!0},"nhm-marketing":{value:null,exists:!1},"nhm-performance":{value:null,exists:!1}},COOKIE_BANNER:{state:{show:!1},get show(){return this.state.show},set show(e){this.state.show=e,this.handleCookieBannerTabbing()},handleCookieBannerTabbing(){1==this.state.show&&m(document.querySelector("#js-cookie-bar"))}},pushCookiesToGTM(){let e={event:"cookie-preferences-set"};Object.keys(this.COOKIE_PREFERENCES).forEach(t=>{e[t]=this.COOKIE_PREFERENCES[t].value}),window.dataLayer.push(e)},pushCookiesToAdobeLaunch(){let e=new CustomEvent("cookie-preferences-set");Object.keys(this.COOKIE_PREFERENCES).forEach(t=>{e[t]=this.COOKIE_PREFERENCES[t].value}),document.dispatchEvent(e)},handlePreferenceToggle(e){let t=e.getAttribute("id");this.COOKIE_PREFERENCES[t].value=e.checked},handleCookieBannerFormSubmission(e){let t=e.getAttribute("action"),i=e.getAttribute("method");Object.keys(this.COOKIE_PREFERENCES).forEach(e=>{this.COOKIE_PREFERENCES[e].value=!0}),$.ajax({url:t,type:i,headers:{"Content-Type":"application/json"},data:JSON.stringify(this.COOKIE_PREFERENCES),success:(e,t,i)=>{if(200===i.status){this.COOKIE_BANNER.show=!1,this.pushCookiesToGTM(),this.pushCookiesToAdobeLaunch();const e=document.getElementById("js-cookie-bar"),t=document.querySelector(".body-overlay");if(!e)return;e.setAttribute("data-show-cookie-banner",this.COOKIE_BANNER.show),t.setAttribute("data-show-cookie-banner-overlay",this.COOKIE_BANNER.show)}else console.error("There was a problem saving cookies")}})},handleCookieFormSubmission(e){let t=e.getAttribute("action"),i=e.getAttribute("method");$.ajax({url:t,type:i,headers:{"Content-Type":"application/json"},data:JSON.stringify(this.COOKIE_PREFERENCES),success:(e,t,i)=>{if(200===i.status){this.pushCookiesToGTM(),this.pushCookiesToAdobeLaunch();const e=document.querySelector(".cookies-success-container");if(!e)return;e.setAttribute("data-show-cookie-success-message",!0)}else{const e=document.querySelector(".cookies-error-container");if(!e)return;e.setAttribute("data-show-cookie-error-message",!0)}window.scrollTo(0,0)}})},initPreferences(){document.querySelectorAll(".cookie-form__preference").forEach(e=>{let t=e.getAttribute("id"),i="1"==this.COOKIE_PREFERENCES[t].value;e.checked=i,e.addEventListener("change",e=>{this.handlePreferenceToggle(e.target)})})},initCookies(){Object.keys(this.COOKIE_PREFERENCES).forEach(e=>{Cookies.get(e)?(this.COOKIE_PREFERENCES[e].value=1==Cookies.get(e),this.COOKIE_PREFERENCES[e].exists=!0):(this.COOKIE_PREFERENCES["nhm-functional-202308"].value=!0,this.COOKIE_PREFERENCES["nhm-marketing"].value=!1,this.COOKIE_PREFERENCES["nhm-performance"].value=!1,this.COOKIE_PREFERENCES[e].exists=!1,this.COOKIE_BANNER.show=!0)}),this.initPreferences();const e=document.getElementById("js-cookie-bar"),t=document.querySelector(".body-overlay");e&&(e.setAttribute("data-show-cookie-banner",this.COOKIE_BANNER.show),t.setAttribute("data-show-cookie-banner-overlay",this.COOKIE_BANNER.show))},initCookieForm(){let e=document.getElementById("cookie-form");e&&e.addEventListener("submit",t=>{t.preventDefault(),this.handleCookieFormSubmission(e)})},initCookieBannerForm(){let e=document.getElementById("cookie-banner-form");e&&e.addEventListener("submit",t=>{t.preventDefault(),this.handleCookieBannerFormSubmission(e)})},init(){this.initCookies(),this.initCookieForm(),this.initCookieBannerForm()}},w={resizeId:null,resizeDelay:100,device:{width:null,wasMobile:null,set setWidth(e){this.width=e,this.initViewportDefaultDisplay()},get getWidth(){return this.width},set setWasMobile(e){this.wasMobile=e},get getWasMobile(){return this.wasMobile},get getIsMobile(){return this.width<=1023},initViewportDefaultDisplay(){if(this.getWasMobile!=this.getIsMobile){let e,t,i,n=document.querySelector(".global-header"),o=document.querySelector(".search-panel");o.setAttribute("aria-hidden","true"),o.classList.remove("is-active"),o.querySelectorAll("a, button, input").forEach(e=>{e.setAttribute("tabindex","-1")}),this.getIsMobile?(i=n.querySelectorAll("[data-aria-hidden-mobile]"),i.forEach(e=>{let t=e.getAttribute("data-aria-hidden-mobile");e.setAttribute("aria-hidden",t)})):(e=n.querySelectorAll(".is-active"),t=n.querySelectorAll(".is-not-scrollable"),n.classList.remove("is-active"),e.length>0&&e.forEach(e=>e.classList.remove("is-active")),document.querySelector("html").classList.remove("is-not-scrollable"),document.body.classList.remove("is-not-scrollable"),t.length>0&&t.forEach(e=>e.classList.remove("is-not-scrollable")),i=n.querySelectorAll("[data-aria-hidden-desktop]"),i.forEach(e=>{let t=e.getAttribute("data-aria-hidden-desktop");e.setAttribute("aria-hidden",t)})),this.setWasMobile=this.getIsMobile}}},setDeviceWidth(){let e=window.innerWidth||document.documentElement.clientWidth;this.device.setWidth=e},initDisplaySizeWatcher(){window.addEventListener("resize",()=>{null!==this.resizeId&&clearTimeout(this.resizeId),this.resizeId=setTimeout(()=>{this.resizeId=null,this.setDeviceWidth()},this.resizeDelay)})},initNavigation(){this.setDeviceWidth();const e=e=>$(".main-section").hasClass(e);(e("discover")||e("visit")||e("support-us"))&&($("body").addClass("js-global-header--nav-list__body"),$(".global-header").addClass("js-global-header--nav-list__header"),$(".subnav__visit").removeClass("js-global-header--nav-list__hide")),window.location.href.indexOf("deworm3")>=0&&($(".breadcrumb").addClass("hidden"),$("body").addClass("js-global-header--nav-list__body"),$(".global-header").addClass("js-global-header--nav-list__header")),$(document).on("change","#visit-secondary-nav-select",(function(e){e.preventDefault(),window.location=this.value}))},initAutoHide(){let e,t,i,n,o=document.querySelector(".global-header"),s=o.offsetHeight,r=0,a=0;window.addEventListener("scroll",()=>{e=!0}),setInterval((function(){e&&(l(),e=!1)}),20);const l=()=>{s=o.offsetHeight,t=window.pageYOffset,i=r-t,n=parseInt(window.getComputedStyle(o).getPropertyValue("top"))+i,a+=i,t<=0?a=0:i>0?a=a>0?0:a:i<0&&(a=Math.abs(a)>s?-s:a),o.style.transform=`translateY(${a}px)`,r=t}},ariaStateChanger:e=>"true"==e?"false":"true",toggleMobileMenu(e){let t=document.querySelector(".global-header"),i=document.querySelector(".global-header__nav-wrapper");t.classList.contains("is-active");i.setAttribute("aria-hidden",this.ariaStateChanger(i.getAttribute("aria-hidden"))),document.querySelector("html","body").classList.toggle("is-not-scrollable"),t.classList.toggle("is-active"),document.querySelector(".global-header__nav-item-children").classList.remove("is-active","is-not-scrollable"),t.classList.contains("is-active")&&(i.style.visibility="visible")},openSubMenu(e){let t=document.querySelector(e.currentTarget.getAttribute("data-parent-menu")),i=document.querySelector(e.currentTarget.getAttribute("data-sub-menu"));i.setAttribute("aria-hidden","false"),t.classList.add("is-not-scrollable"),i.classList.add("is-active"),i.style.visibility="visible"},closeSubMenu(){let e=document.querySelector(event.currentTarget.getAttribute("data-parent-menu")),t=document.querySelector(event.currentTarget.getAttribute("data-current-menu"));t.setAttribute("aria-hidden","false"),e.classList.remove("is-not-scrollable"),t.classList.remove("is-active"),setTimeout(()=>{t.style.visibility="hidden"},250)},openSearchPanel(){let e=document.querySelector(".search-panel");document.querySelector("body, html").classList.add("is-not-scrollable"),e.classList.add("is-active"),e.setAttribute("aria-hidden","false"),e.querySelectorAll("a, button, input").forEach(e=>{e.removeAttribute("tabindex")});let t=document.getElementById("searchBar");setTimeout(()=>{t.focus()},500)},closeSearchPanel(){let e=document.querySelector(".search-panel");document.querySelector("body, html").classList.remove("is-not-scrollable"),e.classList.remove("is-active"),e.setAttribute("aria-hidden","true"),e.querySelectorAll("a, button, input").forEach(e=>{e.setAttribute("tabIndex","-1")})},toggleMenuOnAnchorLinkClick(){[...document.querySelectorAll(".global-header a")].filter(e=>e.href.includes("#")).forEach(e=>{e.addEventListener("click",e=>{window.innerWidth<1024&&this.toggleMobileMenu().bind(this)})})},initSearchPanelEvents(){window.openSearchPanel=this.openSearchPanel.bind(this),window.closeSearchPanel=this.closeSearchPanel.bind(this)},initMobileMenuEvents(){window.toggleMobileMenu=this.toggleMobileMenu.bind(this),window.openSubMenu=this.openSubMenu.bind(this),window.closeSubMenu=this.closeSubMenu.bind(this),this.toggleMenuOnAnchorLinkClick()},init(){this.initSearchPanelEvents(),this.initDisplaySizeWatcher(),this.initNavigation(),this.initMobileMenuEvents()},windowInit(){this.initAutoHide()}},A={initSvgInliner(){let e=(e,t)=>{e.selectAll("path").forEach((e,i)=>{e.animate({stroke:t},200)})},t=0;$(".svg-ico").each((function(i){t++;let n,o=$(this),s=o.data("svg-src"),r=o.data("svg-title"),a=(o.attr("alt"),o.data("stroke-width"));o.attr("id","svg-"+r+"-"+t),n=Snap("#svg-"+r+"-"+t),Snap.load(s,t=>{let i;if(n.append(t),i=void 0!==o.data("base-color")&&""!==o.data("base-color")?o.data("base-color"):o.css("color"),e(n,i),void 0!==o.data("stroke-width")&&("string"==typeof a&&(a=parseInt(a)),n.attr({strokeWidth:a})),o.data("hover-color")){let t=o.data("hover-color");o.closest("a").hover(o=>{"mouseenter"===o.type&&e(n,t),"mouseleave"===o.type&&e(n,i)})}if(void 0!==o.data("mobile-base")){let t=o.data("mobile-base");$(window).width()<768&&(e(n,t),o.closest("a").off("mouseenter mouseleave")),$(window).on("resize",s=>{$(this).width()<768?(e(n,t),o.closest("a").off("mouseenter mouseleave")):(e(n,o.data("base-color")),o.closest("a").hover(t=>{"mouseenter"===t.type&&e(n,hoverColor),"mouseleave"===t.type&&e(n,i)}))})}})}))},init(){this.initSvgInliner()}},L={addYoutubeIframeAPIToPage(){let e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)},onYouTubeIframeAPIReady(){const e=document.querySelectorAll(".video-wrapper");let t=document.querySelectorAll(".js--bigsplash-video");(e.length||t.length)&&(e.forEach(e=>{let t=e.dataset.nhmVideoid,i=(new YT.Player(t,{videoId:t,playerVars:{loop:1,playlist:t,autoplay:0,controls:1,showinfo:0,color:"white"},events:{onReady:this.onPlayerReady}}),e.querySelector("iframe"));i.setAttribute("title","Video from YouTube"),i.setAttribute("loading","lazy")}),window.screen.width<=767||(t.forEach(e=>{let t=document.querySelector(".js--bigsplash-video--controls-pause"),i=document.querySelector(".js--bigsplash-video--controls-play"),n=e.dataset.nhmVideoid,o=new YT.Player(n,{height:"100%",videoId:n,playerVars:{modestbranding:1,autoplay:1,rel:0,controls:0,showinfo:0,disablekb:1},events:{onReady:e=>{e.target.playVideo()},onStateChange:e=>{e.data===YT.PlayerState.ENDED&&o.playVideo()}}});e.querySelector("iframe").setAttribute("title","Video from YouTube"),i.addEventListener("click",e=>{e.preventDefault(),o.playVideo()}),t.addEventListener("click",e=>{e.preventDefault(),o.pauseVideo()})}),this.resizeYoutubeFrames()))},resizeYoutubeFrames(){document.querySelectorAll("iframe[src^='http://www.youtube.com'],iframe[src^='https://www.youtube.com']").forEach(e=>{let t=""+parseFloat(e.offsetHeight/e.offsetWidth).toFixed(3).replace(/^0./,""),i=`${t.slice(0,2)}.${t.slice(2,3)}%`;e.removeAttribute("height"),e.removeAttribute("width");let n=e.closest(".video-wrapper");n?n.style.paddingBottom=i:console.warn("No .video-wrapper found")})},onPlayerReady(e){let t=e.target;t.playWhenReady&&t.playVideo()},init(){this.addYoutubeIframeAPIToPage()}},_={initDefaultCarousel(){$(".carousel").each((function(e){let t=$(this),i=t.find("li").length,n=t.data("nhm-thumbnails"),o=t.data("nhm-autoscroll"),s=t.data("nhm-autoscroll-duration"),r=t.data("nhm-grouping")||1,a=(e=t.lightSlider({gallery:n,item:r,controls:!0,pager:!0,slideMove:r,slideMargin:0,thumbMargin:4,auto:o,pause:s,loop:!0,currentPagerPosition:"left",mode:"slide",onAfterSlide:()=>{let t=e.getCurrentSlideCount(),i=e.find("li").length,n=e.closest(".lSSlideOuter").find(".lSPrev"),o=e.closest(".lSSlideOuter").find(".lSNext");1===t?$(window).width()<1025?(n.css("display","none"),o.css("display","none")):(n.fadeOut(100),o.fadeIn(100)):t===i?$(window).width()<1025?(n.css("display","none"),o.css("display","none")):(n.fadeIn(100),o.fadeOut(100)):$(window).width()<1025?(n.css("display","none"),o.css("display","none")):(n.fadeIn(100),o.fadeIn(100))},onSliderLoad:()=>{let n=t.closest(".carousel-wrapper").width(),o=Math.ceil(n/i-i);a.find(".lSGallery").find("li").css("min-width",o+"px").css("max-width",o+"px"),prev=e.closest(".lSSlideOuter").find(".lSPrev"),next=e.closest(".lSSlideOuter").find(".lSNext"),$(window).width()<1025?(prev.css("display","none"),next.css("display","none")):(prev.fadeOut(100),next.fadeIn(100))},onBeforeStart:()=>{$(".js--carousel-image").css("display","block")}})).closest(".lSSlideOuter");a.find(".lSAction").addClass("desktop"),setTimeout(()=>{let e=document.querySelector(".lSPager.lSGallery");e.setAttribute("aria-hidden",!0),e.querySelectorAll("li").forEach(e=>{e.querySelector("img").setAttribute("alt","")})},2e3)}))},initEventSlider(){var e=jQuery(".event-slider").lightSlider({item:3,slideMove:3,slideMargin:20,easing:"easeInOut",controls:!0,prevHtml:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 23" width="12" height="23"><title>Show previous slide</title><polyline points="10 2 1 11 10 21"></polyline></svg>',nextHtml:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 23" width="12" height="23"><title>Show next slide</title><polyline points="2 2 10 11 2 21"></polyline></svg>',responsive:[{breakpoint:768,settings:{item:1,slideMove:1}}],onAfterSlide:function(){var t=e.getCurrentSlideCount(),i=e.closest(".lSSlideOuter").find(".lSpg li").length,n=e.closest(".lSSlideOuter").find(".lSPrev"),o=e.closest(".lSSlideOuter").find(".lSNext");1===t?(n.fadeOut(100),o.fadeIn(100)):t===i?(n.fadeIn(100),o.fadeOut(100)):(n.fadeIn(100),o.fadeIn(100))},onBeforeStart:function(){$(".js--carousel-image").css("display","block")}})},init(){this.initDefaultCarousel(),this.initEventSlider()}},O={transitionhandler(){let e;function t(){document.querySelector("body").classList.remove("disable-transitions")}window.addEventListener("resize",(function(){document.querySelector("body").classList.add("disable-transitions"),clearTimeout(e),e=setTimeout(t,1e3)}))},init(){this.transitionhandler()}},T={initScrollListener(e,t){t&&window.addEventListener("scroll",()=>{e.getBoundingClientRect().top<0?t.setAttribute("data-state","active"):t.setAttribute("data-state","inactive")})},initTagListToggle(e,t){e&&t&&e.addEventListener("click",()=>{"active"==t.getAttribute("data-state")?(e.setAttribute("data-state","inactive"),t.setAttribute("data-state","inactive"),t.setAttribute("aria-hidden",""),window.dataLayer.push({event:"GAEvent",eventCategory:"user experience",eventAction:"list component - mobile dropdown button clicked",eventLabel:"list closed"})):(e.setAttribute("data-state","active"),t.setAttribute("data-state","active"),t.removeAttribute("aria-hidden"),window.dataLayer.push({event:"GAEvent",eventCategory:"user experience",eventAction:"list component - mobile dropdown button clicked",eventLabel:"list opened"}))})},setUp(){const e=document.querySelectorAll(".list-wrapper");e&&e.forEach(e=>{const t=e.querySelector(".list__toggle"),i=e.querySelector(".list__items");this.initTagListToggle(t,i);const n=e.querySelector(".list__back-to-list");this.initScrollListener(e,n)})},init(){this.setUp()}},k={initCaptions(){window.addEventListener("load",()=>{this.captionSetup()})},captionSetup(){document.querySelectorAll("[data-caption-truncation]").forEach(e=>{if(e.clientHeight>70){e.insertAdjacentHTML("beforeend",'<a href="#" aria-label="Read more" class="read-link">Read more</a>'),e.classList.add("is-condensed");let t=e.querySelector("a.read-link");t.addEventListener("click",i=>{i.preventDefault(),e.classList.toggle("is-condensed"),e.classList.contains("is-condensed")?t.textContent="Read more":t.textContent="Read less"})}})},init(){this.initCaptions()}},I={createElementFromHTML(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild},addExternalLinkIconToButtons(){const e=document.querySelectorAll('a[target="_blank"].button, .button a[target="_blank"]');e&&e.forEach(e=>{e.innerHTML;e.classList.add("button--with-icon");const t=e.querySelector(".button__icon")||e.querySelector("svg"),i=this.createElementFromHTML('\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="external-link-icon-svg">\n          <path d="M21.334 21.334H2.666V2.666H12V0H2.666C1.95893 0 1.28083 0.280881 0.780854 0.780853C0.280882 1.28083 7.50255e-07 1.95893 7.50255e-07 2.666V21.332C-0.00026202 21.6823 0.0685024 22.0292 0.202364 22.3528C0.336225 22.6765 0.532559 22.9707 0.780146 23.2184C1.02773 23.4662 1.32172 23.6628 1.6453 23.7969C1.96889 23.931 2.31573 24 2.666 24H21.332C22.0388 23.9984 22.7162 23.7171 23.2161 23.2175C23.7161 22.7179 23.9979 22.0408 24 21.334V12H21.334V21.334ZM14.666 0V2.666H19.452L6.346 15.774L8.226 17.654L21.332 4.548V9.334H24V0H14.666Z" fill="#333333"/>\n        </svg>\n      ');e.replaceChild(i,t)})},init(){this.addExternalLinkIconToButtons()}},C={savedArticles:[],SAVED_ARTICLES_LIST:null,SAVED_ARTICLES_COUNT:null,BADGE_COUNT:null,SAVED_ARTICLES_COUNT_LIST:null,SAVE_ARTICLE_BUTTON:null,MODAL:null,MODAL_OPEN:null,MODAL_CLOSE:null,OVERLAY:null,setupModal(){this.OVERLAY=document.getElementById("saved-articles__overlay"),this.MODAL=document.getElementById("saved-articles__modal"),this.MODAL_OPEN=document.getElementById("saved-articles__modal-open"),this.MODAL_CLOSE=document.getElementById("saved-articles__modal-close"),this.OVERLAY&&this.MODAL&&this.MODAL_OPEN&&this.MODAL_CLOSE&&(this.MODAL_OPEN.addEventListener("click",()=>this.toggleModal("open")),this.MODAL_CLOSE.addEventListener("click",()=>this.toggleModal("closed")),m(this.MODAL))},setUpSaveButton(){this.SAVE_ARTICLE_BUTTON=document.getElementById("saved-articles__save-button"),this.SAVE_ARTICLE_BUTTON&&(this.SAVE_ARTICLE_BUTTON.addEventListener("click",e=>this.saveArticle(e)),this.setupArticles())},setupArticles(){if(this.SAVED_ARTICLES_LIST=document.getElementById("saved-articles__list"),this.SAVED_ARTICLES_COUNT=document.getElementById("saved-articles__count"),this.BADGE_COUNT=document.getElementById("badge__count"),this.SAVED_ARTICLES_LIST.innerHTML="",window.localStorage.getItem("saved-articles")&&(this.savedArticles=JSON.parse(window.localStorage.getItem("saved-articles"))),this.SAVED_ARTICLES_COUNT.innerHTML=`&nbsp;(${this.savedArticles.length})`,this.BADGE_COUNT.innerHTML=this.savedArticles.length,this.savedArticles.length<1){document.getElementById("saved-articles__empty").style.display="block"}else{this.savedArticles.forEach(e=>{let t=document.createElement("li");t.classList.add("saved-articles__list-item"),t.innerHTML=`\n\t\t\t\t\t\t<div class="saved-article__left">\n\t\t\t\t\t\t\t<div class="saved-article__image-wrapper">\n\t\t\t\t\t\t\t\t<img src="${e.image}" class="saved-article__image" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="saved-article__center">\n\t\t\t\t\t\t\t<a href=${e.link}>${e.title}</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="saved-article__right">\n\t\t\t\t\t\t\t<button class="saved-articles__remove-button" data-remove-article="${e.link}">\n\t\t\t\t\t\t\t\t<span role="img" aria-label="Remove from saved articles" class="saved-articles__close-icon"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`,this.SAVED_ARTICLES_LIST.append(t)}),document.getElementById("saved-articles__empty").style.display="none"}this.savedArticles.find(e=>e.link==window.location.pathname)?this.SAVE_ARTICLE_BUTTON.setAttribute("disabled","disabled"):this.SAVE_ARTICLE_BUTTON.removeAttribute("disabled"),this.initRemoveArticleButtons()},initRemoveArticleButtons(){document.querySelectorAll("button[data-remove-article]").forEach(e=>{e.addEventListener("click",e=>this.removeArticle(e))}),m(this.MODAL)},toggleModal(e){this.OVERLAY.setAttribute("data-state",e),"open"==e?(this.MODAL.focus(),this.handleOutsideClick()):"closed"==e&&this.MODAL_OPEN.focus()},handleOutsideClick(){window.addEventListener("click",e=>{"saved-articles__overlay"==e.target.id&&this.OVERLAY.setAttribute("data-state","closed")})},saveArticle(e){e.preventDefault();let t,i=window.location.pathname,n=document.querySelector("h1").innerText,o=document.getElementById("main-content").querySelector(".discover-image"),s=document.getElementById("main-content").querySelector(".discover-video");if(o)t=document.getElementById("main-content").querySelector(".discover-image").querySelector("img").src;else if(s){t=`https://img.youtube.com/vi/${document.getElementById("main-content").querySelector(".video-wrapper").querySelector("iframe").getAttribute("id")}/0.jpg`}else t=document.getElementById("main-content").querySelector("img").src;let r={link:i,title:n,image:t};this.savedArticles.push(r),window.localStorage.setItem("saved-articles",JSON.stringify(this.savedArticles)),this.setupArticles(),this.MODAL_CLOSE.focus(),m(this.MODAL)},removeArticle(e){let t=e.target.hasAttribute("data-remove-article")?e.target.getAttribute("data-remove-article"):e.target.parentElement.getAttribute("data-remove-article"),i=this.savedArticles.filter(e=>e.link!=t);window.localStorage.setItem("saved-articles",JSON.stringify(i)),this.setupArticles()},init(){this.setupModal(),this.setUpSaveButton()}},q={initFetchAlert(){const e=document.querySelector(".alert-overlay"),t=document.querySelector(".alert-modal"),i=document.querySelector(".alert-modal__title"),n=document.querySelector(".alert-modal__body"),o=document.querySelector(".persistent-alert"),s=document.querySelector(".persistent-alert__body"),r=document.getElementById("cookie-bar");$.ajax({url:"https://naturalhistorymuseum.blog/wp-json/wp/v2/pages/13866",type:"GET",crossDomain:!0,cache:!1,success:function(a){"publish"===a.status&&(t&&document.referrer.indexOf("nhm.ac.uk")<0&&document.referrer.indexOf("localhost")<0&&(e.classList.add("is-active"),t.classList.add("is-active"),i.innerHTML=a.title.rendered,n.innerHTML=a.content.rendered.replace(/<script[^>]*>/gi," \x3c!-- ").replace(/<\/script>/gi," --\x3e "),window.scrollTo({top:0})),o&&(o.classList.add("is-active"),s.innerHTML=a.excerpt.rendered,r&&(r.style.display="none")))},error:function(e,t){console.error(e,t)}})},init(){this.initFetchAlert()}};const N={init(){v.init(),p.init(),b.init(),g.init(),f.init(),w.init(),S.init(),A.init(),L.init(),_.init(),O.init(),T.init(),k.init(),I.init(),C.init(),l.init(),u.init(),c.init(),h.init(),a.init(),r.init(),s.init(),y.init(),d.init(),q.init()},windowInit(){w.windowInit(),E.init()}};window.onYouTubeIframeAPIReady=()=>{L.onYouTubeIframeAPIReady()},$(document).ready(()=>{N.init(),$(document).foundation()}),$(window).ready(()=>{N.windowInit()})}]);